---
layout: default
---
<div id="post">
{{ content }}
</div>

<!-- <div id="related">
  <h2>Related Posts</h2>
  <ul class="posts">
    {% for post in site.related_posts limit:3 %}
      <li><span>{{ post.date | date_to_string }}</span> &raquo; <a href="{{ post.url }}">{{ post.title }}</a></li>
    {% endfor %}
  </ul>
</div> -->

<h2>Comments</h2>
<form action="" method="post">
  <textarea id="message" cols="50" rows="3"></textarea>
  <input type="button" id="tweetBtn" value="Preview Tweet"/> 
</form> 
<div class="tweet" id="comment">
  <img src="/images/loading.gif"></img> Calculating comment tag...
</div>
<script type='text/javascript'>
  $(document).ready(function(){
    // set up default options
    var defaults = {
      version:    '2.0.1',
      login:      'caecus',
      apiKey:     'R_805cccec98054fee49e9f974d28623bf',
      history:    '0',
      longUrl:    'http://www.lewisoaten.com{{ page.url }}'
    };

  // Build the URL to query
  var daurl = "http://api.bit.ly/shorten?"
    +"version="+defaults.version
    +"&longUrl="+defaults.longUrl
    +"&login="+defaults.login
    +"&apiKey="+defaults.apiKey
    +"&history="+defaults.history
    +"&format=json&callback=?";

    // Utilize the bit.ly API
    $.getJSON(daurl, function(data){
        // Setup comment box
        $('#tweetBtn').click( function() {
          var url = "http://twitter.com/#search?q=" + data.results[defaults.longUrl].shortUrl + "&status=";
          url += $('textarea#message').val() + " " + data.results[defaults.longUrl].shortUrl;
          window.open(url);
        });

        // Load comments
        $("#comment").html("");
        $("#comment").tweet({
          avatar_size: 32,
          count: 20,
          query: data.results[defaults.longUrl].shortUrl,
          loading_text: '<img src="/images/loading.gif"></img> Loading comments...',
          callback: function(){
            // Clear out links to this page
            var oldHTML = $("#comment").html();
            var newHTML = oldHTML.replace(/data.results[defaults.longUrl].shortUrl/g, '');
            $("textarea#message").val( oldHTML + "\n----------\n" + newHTML);
            }
        });
    });
  });
</script>
